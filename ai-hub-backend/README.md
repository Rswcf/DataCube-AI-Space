# AI Hub Backend

FastAPI backend for the AI Information Hub - bilingual AI news aggregator with YouTube video integration.

## Features

- RESTful API for tech news, investment data, tips, trends
- YouTube video integration (5 videos/week interspersed in tech feed)
- **Real-time stock data** via Polygon.io API (Secondary Market)
- PostgreSQL database with SQLAlchemy ORM
- 4-stage data collection pipeline
- Two-model LLM approach (classifier + processor)
- Tips sources bypass classification (Reddit, Simon Willison)
- Bilingual content support (DE/EN)

## LLM Models

| Purpose | Model | Notes |
|---------|-------|-------|
| **Classification** | `z-ai/glm-4.5-air:free` | Free tier, classifies tech/investment |
| **Content Processing** | `deepseek/deepseek-v3.2` | Generates bilingual content |

## Data Collection Pipeline (Overview)

```
Stage 1: Fetch raw data
    â€¢ RSS Feeds (22 sources)
    â€¢ Hacker News (Algolia API)
    â€¢ YouTube (Data API v3)
    â†“
Stage 2: Classify articles
    â€¢ Tips sources â†’ skip classification (direct to tips)
    â€¢ Other sources â†’ LLM classification (tech/investment)
    â†“
Stage 3: Parallel LLM processing
    â€¢ Tech: 30 posts
    â€¢ Investment: primary/secondary/M&A
    â€¢ Tips: 15 per language
    â€¢ Videos: 5 summaries
    â†“
Stage 4: Save to PostgreSQL
```

---

## Complete Data Pipeline (Deep Dive)

This section provides a comprehensive overview of the entire data flow from source fetching to frontend display.

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                    AI HUB BACKEND - COMPLETE DATA PIPELINE                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         STAGE 1: DATA FETCHING                                               â”‚
â”‚                                         collector.py: stage1_fetch_and_store()                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                             â”‚                                             â”‚
        â–¼                                             â–¼                                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   RSS FEEDS (22)      â”‚                 â”‚    HACKER NEWS API    â”‚                 â”‚    YOUTUBE API        â”‚
â”‚   rss_fetcher.py      â”‚                 â”‚    hn_fetcher.py      â”‚                 â”‚   youtube_fetcher.py  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Tech Sources:         â”‚                 â”‚ Algolia Search API    â”‚                 â”‚ Search keywords (25): â”‚
â”‚ â€¢ Hugging Face Blog   â”‚                 â”‚ â€¢ 18 business queries â”‚                 â”‚ â€¢ "AI news this week" â”‚
â”‚ â€¢ MIT Tech Review     â”‚                 â”‚ â€¢ min_points: 100     â”‚                 â”‚ â€¢ "ChatGPT for biz"   â”‚
â”‚ â€¢ The Decoder         â”‚                 â”‚ â€¢ days: 7             â”‚                 â”‚ â€¢ "AI for Excel"      â”‚
â”‚                       â”‚                 â”‚ â€¢ limit: 50           â”‚                 â”‚ â€¢ "KI News deutsch"   â”‚
â”‚ Investment Sources:   â”‚                 â”‚                       â”‚                 â”‚                       â”‚
â”‚ â€¢ TechCrunch Funding  â”‚                 â”‚ HN Queries include:   â”‚                 â”‚ Fetches:              â”‚
â”‚ â€¢ Crunchbase News     â”‚                 â”‚ â€¢ AI, LLM, ChatGPT    â”‚                 â”‚ â€¢ Video metadata      â”‚
â”‚ â€¢ Sifted, VentureBeat â”‚                 â”‚ â€¢ Perplexity, DeepSeekâ”‚                 â”‚ â€¢ Channel info        â”‚
â”‚ â€¢ 36Kr (Chinese)      â”‚                 â”‚ â€¢ AI startup/funding  â”‚                 â”‚ â€¢ Transcripts         â”‚
â”‚                       â”‚                 â”‚                       â”‚                 â”‚                       â”‚
â”‚ M&A Sources (7):      â”‚                 â”‚                       â”‚                 â”‚                       â”‚
â”‚ â€¢ See M&A section     â”‚                 â”‚                       â”‚                 â”‚                       â”‚
â”‚                       â”‚                 â”‚                       â”‚                 â”‚                       â”‚
â”‚ Tips Sources (14):    â”‚                 â”‚                       â”‚                 â”‚                       â”‚
â”‚ â€¢ Simon Willison Blog â”‚                 â”‚                       â”‚                 â”‚                       â”‚
â”‚ â€¢ One Useful Thing    â”‚                 â”‚                       â”‚                 â”‚                       â”‚
â”‚ â€¢ Reddit: ChatGPT,    â”‚                 â”‚                       â”‚                 â”‚                       â”‚
â”‚   ClaudeAI, OpenAI,   â”‚                 â”‚                       â”‚                 â”‚                       â”‚
â”‚   perplexity_ai,      â”‚                 â”‚                       â”‚                 â”‚                       â”‚
â”‚   NotebookLM, etc.    â”‚                 â”‚                       â”‚                 â”‚                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚ ~150 articles                           â”‚ ~50 articles                            â”‚ ~10 videos
            â”‚                                         â”‚                                         â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                      â”‚
                                                      â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚      ISO Week Boundary Filter       â”‚
                                    â”‚   get_week_boundaries(week_id)      â”‚
                                    â”‚   is_article_in_week()              â”‚
                                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                    â”‚ Example: Week 06 = 2026-02-02 ~     â”‚
                                    â”‚          2026-02-08                 â”‚
                                    â”‚ Articles outside boundary filtered  â”‚
                                    â”‚ No-date articles: lenient (keep)    â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                      â”‚
                                                      â”‚ After filter: ~100 articles + 10 videos
                                                      â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚        Save to Database             â”‚
                                    â”‚   RawArticle / RawVideo tables      â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                      â”‚
                                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         STAGE 2: LLM CLASSIFICATION                                          â”‚
â”‚                                         collector.py: stage2_classify_articles()                             â”‚
â”‚                                         llm_processor.py: classify_articles()                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                      â”‚
                                                      â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚           LLM Classifier                       â”‚
                              â”‚   Model: z-ai/glm-4.5-air:free (OpenRouter)    â”‚
                              â”‚   Temperature: 0.1 (very low randomness)       â”‚
                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                              â”‚   Input: ~100 articles (title + summary)       â”‚
                              â”‚                                                â”‚
                              â”‚   Classification Rules:                        â”‚
                              â”‚   â€¢ "tech": breakthroughs, models, papers      â”‚
                              â”‚   â€¢ "investment": funding, VC, IPO, M&A        â”‚
                              â”‚   â€¢ "tips": tutorials, prompts, workflows      â”‚
                              â”‚                                                â”‚
                              â”‚   Output per article:                          â”‚
                              â”‚   {                                            â”‚
                              â”‚     "index": 0,                                â”‚
                              â”‚     "section": "tech",                         â”‚
                              â”‚     "relevance": 0.9,    â† importance score    â”‚
                              â”‚     "duplicate_of": null â† deduplication       â”‚
                              â”‚   }                                            â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                              â”‚                              â”‚
                    â–¼                              â–¼                              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Tips Sources     â”‚          â”‚  Sort by          â”‚          â”‚  Duplicate        â”‚
        â”‚  Special Handling â”‚          â”‚  Relevance DESC   â”‚          â”‚  Detection        â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ Reddit/Simon skip â”‚          â”‚ High-score first  â”‚          â”‚ duplicate_of â†’    â”‚
        â”‚ LLM classificationâ”‚          â”‚ for selection     â”‚          â”‚ points to better  â”‚
        â”‚ Direct tags:      â”‚          â”‚                   â”‚          â”‚ article on same   â”‚
        â”‚ section="tips"    â”‚          â”‚                   â”‚          â”‚ topic             â”‚
        â”‚ relevance=0.8     â”‚          â”‚                   â”‚          â”‚                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                              â”‚                              â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”‚
                                                   â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚              Classified Article Pool           â”‚
                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                              â”‚   tech_articles:       ~15-30 (by relevance)   â”‚
                              â”‚   investment_articles: ~60-100                 â”‚
                              â”‚   tips_articles:       ~10-15                  â”‚
                              â”‚   videos:              ~10                     â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”‚
                                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    STAGE 3: PARALLEL LLM PROCESSING                                          â”‚
â”‚                                    collector.py: stage3_parallel_processing()                                â”‚
â”‚                                    ThreadPoolExecutor(max_workers=4)                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                     â”‚                   â”‚                   â”‚                     â”‚
         â–¼                     â–¼                   â–¼                   â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  process_tech   â”‚   â”‚process_investmentâ”‚  â”‚  process_tips   â”‚   â”‚ process_videos  â”‚   â”‚ generate_trends â”‚
â”‚    _articles()  â”‚   â”‚   _articles()   â”‚   â”‚   _articles()   â”‚   â”‚       ()        â”‚   â”‚       ()        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Model:          â”‚   â”‚ Model:          â”‚   â”‚ Model:          â”‚   â”‚ Model:          â”‚   â”‚ Model:          â”‚
â”‚ deepseek-v3.2   â”‚   â”‚ deepseek-v3.2   â”‚   â”‚ deepseek-v3.2   â”‚   â”‚ deepseek-v3.2   â”‚   â”‚ deepseek-v3.2   â”‚
â”‚ Temp: 0.3       â”‚   â”‚ Temp: 0.3       â”‚   â”‚ Temp: 0.2       â”‚   â”‚ Temp: 0.3       â”‚   â”‚ Temp: 0.3       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Input: top 40   â”‚   â”‚ Input: all      â”‚   â”‚ Input: top 15   â”‚   â”‚ Input: top 20   â”‚   â”‚ Input: tech +   â”‚
â”‚ (by relevance)  â”‚   â”‚ investment      â”‚   â”‚ tips articles   â”‚   â”‚ videos          â”‚   â”‚ investment      â”‚
â”‚                 â”‚   â”‚ articles        â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚ results         â”‚
â”‚ LLM Prompt:     â”‚   â”‚ LLM Prompt:     â”‚   â”‚ LLM Prompt:     â”‚   â”‚ LLM Prompt:     â”‚   â”‚ LLM Prompt:     â”‚
â”‚ "Select 30 most â”‚   â”‚ "Categorize to  â”‚   â”‚ "Extract 15     â”‚   â”‚ "Select 5 most  â”‚   â”‚ "Generate 10    â”‚
â”‚  important"     â”‚   â”‚  3 categories   â”‚   â”‚  practical      â”‚   â”‚  valuable"      â”‚   â”‚  weekly trends" â”‚
â”‚                 â”‚   â”‚  max 7 each"    â”‚   â”‚  tips"          â”‚   â”‚                 â”‚   â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Output:         â”‚   â”‚ Output:         â”‚   â”‚ Output:         â”‚   â”‚ Output:         â”‚   â”‚ Output:         â”‚
â”‚ 30 posts DE/EN  â”‚   â”‚ 3 categories    â”‚   â”‚ 15 tips DE/EN   â”‚   â”‚ 5 videos DE/EN  â”‚   â”‚ 10 trends       â”‚
â”‚                 â”‚   â”‚ DE/EN each:     â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚
â”‚ Per post:       â”‚   â”‚ â€¢ primaryMarket â”‚   â”‚ Per tip:        â”‚   â”‚ Per video:      â”‚   â”‚                 â”‚
â”‚ â€¢ content       â”‚   â”‚ â€¢ secondaryMkt  â”‚   â”‚ â€¢ content       â”‚   â”‚ â€¢ title         â”‚   â”‚                 â”‚
â”‚ â€¢ category      â”‚   â”‚ â€¢ ma            â”‚   â”‚ â€¢ tip           â”‚   â”‚ â€¢ summary       â”‚   â”‚                 â”‚
â”‚ â€¢ tags          â”‚   â”‚                 â”‚   â”‚ â€¢ category      â”‚   â”‚ â€¢ category      â”‚   â”‚                 â”‚
â”‚ â€¢ impact        â”‚   â”‚ Per entry:      â”‚   â”‚ â€¢ platform      â”‚   â”‚ â€¢ video_id      â”‚   â”‚                 â”‚
â”‚ â€¢ iconType      â”‚   â”‚ â€¢ content       â”‚   â”‚ â€¢ difficulty    â”‚   â”‚                 â”‚   â”‚                 â”‚
â”‚ â€¢ source        â”‚   â”‚ â€¢ company       â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚
â”‚ â€¢ sourceUrl     â”‚   â”‚ â€¢ amount        â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚
â”‚ â€¢ timestamp     â”‚   â”‚ â€¢ investors     â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚
â”‚                 â”‚   â”‚ â€¢ roundCategory â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ 30 posts            â”‚ 7Ã—3=21              â”‚ 15 tips             â”‚ 5 videos            â”‚ 10 trends
         â”‚                     â”‚                     â”‚                     â”‚                     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
                                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    STAGE 4: SAVE TO DATABASE                                                 â”‚
â”‚                                    collector.py: stage4_save_to_database()                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
                                                     â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚           Video Interspersion Strategy         â”‚
                              â”‚   intersperse_videos()                         â”‚
                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                              â”‚   30 Tech posts + 5 Videos                     â”‚
                              â”‚   Insert positions: 5, 11, 17, 23, 29          â”‚
                              â”‚   Result: 35 mixed items (with display_order)  â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                     â”‚                   â”‚                   â”‚                     â”‚
         â–¼                     â–¼                   â–¼                   â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    TechPost     â”‚   â”‚ PrimaryMarket   â”‚   â”‚ SecondaryMarket â”‚   â”‚     MAPost      â”‚   â”‚    TipPost      â”‚
â”‚     Table       â”‚   â”‚   Post Table    â”‚   â”‚   Post Table    â”‚   â”‚     Table       â”‚   â”‚     Table       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 35 records      â”‚   â”‚ ~7 records      â”‚   â”‚ ~7 records      â”‚   â”‚ ~7 records      â”‚   â”‚ 15 records      â”‚
â”‚ (30 posts +     â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚
â”‚  5 videos)      â”‚   â”‚ Round types:    â”‚   â”‚ Stock market:   â”‚   â”‚ M&A deals:      â”‚   â”‚ Tips with:      â”‚
â”‚                 â”‚   â”‚ â€¢ Early         â”‚   â”‚ â€¢ ticker        â”‚   â”‚ â€¢ acquirer      â”‚   â”‚ â€¢ tip           â”‚
â”‚ Fields:         â”‚   â”‚ â€¢ Series A      â”‚   â”‚ â€¢ price         â”‚   â”‚ â€¢ target        â”‚   â”‚ â€¢ category      â”‚
â”‚ â€¢ content_de/en â”‚   â”‚ â€¢ Series B      â”‚   â”‚ â€¢ change        â”‚   â”‚ â€¢ deal_value    â”‚   â”‚ â€¢ platform      â”‚
â”‚ â€¢ category      â”‚   â”‚ â€¢ Series C+     â”‚   â”‚ â€¢ direction     â”‚   â”‚ â€¢ deal_type     â”‚   â”‚ â€¢ difficulty    â”‚
â”‚ â€¢ tags          â”‚   â”‚ â€¢ Late/PE       â”‚   â”‚ â€¢ market_cap    â”‚   â”‚ â€¢ industry      â”‚   â”‚                 â”‚
â”‚ â€¢ impact        â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚
â”‚ â€¢ is_video      â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚
â”‚ â€¢ display_order â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                     â”‚                     â”‚                     â”‚                     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
                                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                              API ENDPOINTS                                                   â”‚
â”‚                                              app/routers/                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                     â”‚                   â”‚                   â”‚                     â”‚
         â–¼                     â–¼                   â–¼                   â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GET /api/tech/  â”‚   â”‚GET /api/invest- â”‚   â”‚ GET /api/tips/  â”‚   â”‚GET /api/videos/ â”‚   â”‚ GET /api/weeks  â”‚
â”‚    {weekId}     â”‚   â”‚ ment/{weekId}   â”‚   â”‚    {weekId}     â”‚   â”‚    {weekId}     â”‚   â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Returns:        â”‚   â”‚ Returns:        â”‚   â”‚ Returns:        â”‚   â”‚ Returns:        â”‚   â”‚ Returns:        â”‚
â”‚ {               â”‚   â”‚ {               â”‚   â”‚ {               â”‚   â”‚ {               â”‚   â”‚ {               â”‚
â”‚  "de": [...],   â”‚   â”‚  "primaryMkt":  â”‚   â”‚  "de": [...],   â”‚   â”‚  "de": [...],   â”‚   â”‚  "weeks": [     â”‚
â”‚  "en": [...]    â”‚   â”‚    {...},       â”‚   â”‚  "en": [...]    â”‚   â”‚  "en": [...]    â”‚   â”‚   {id, label,   â”‚
â”‚ }               â”‚   â”‚  "secondaryMkt" â”‚   â”‚ }               â”‚   â”‚ }               â”‚   â”‚    current}     â”‚
â”‚                 â”‚   â”‚    {...},       â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚  ]              â”‚
â”‚ 35 mixed items  â”‚   â”‚  "ma": {...}    â”‚   â”‚ 15 Tips         â”‚   â”‚ 5 video details â”‚   â”‚ }               â”‚
â”‚ (posts+videos)  â”‚   â”‚ }               â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                     â”‚                     â”‚                     â”‚                     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
                                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                            FRONTEND DISPLAY                                                  â”‚
â”‚                                            ai-information-hub/ (Next.js)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                     â”‚                   â”‚                   â”‚                     â”‚
         â–¼                     â–¼                   â–¼                   â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   TECH FEED     â”‚   â”‚   INVESTMENT    â”‚   â”‚   TIPS FEED     â”‚   â”‚   VIDEO FEED    â”‚   â”‚   WEEK NAV      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 35 cards        â”‚   â”‚ 3 category tabs â”‚   â”‚ 15 tip cards    â”‚   â”‚ 5 video embeds  â”‚   â”‚ Week selector   â”‚
â”‚ â€¢ Article cards â”‚   â”‚ â€¢ Primary Mkt   â”‚   â”‚ â€¢ Title + detailâ”‚   â”‚ â€¢ YouTube playerâ”‚   â”‚ â€¢ Current week  â”‚
â”‚ â€¢ Video cards   â”‚   â”‚ â€¢ Secondary Mkt â”‚   â”‚ â€¢ Difficulty    â”‚   â”‚ â€¢ Thumbnail     â”‚   â”‚   highlighted   â”‚
â”‚  (at 5,11,17..) â”‚   â”‚ â€¢ M&A           â”‚   â”‚ â€¢ Platform      â”‚   â”‚ â€¢ Duration/viewsâ”‚   â”‚ â€¢ History list  â”‚
â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚
â”‚ Impact badges:  â”‚   â”‚ Round badges:   â”‚   â”‚ Difficulty:     â”‚   â”‚ Categories:     â”‚   â”‚                 â”‚
â”‚ ğŸ”´ Critical     â”‚   â”‚ ğŸŒ± Early        â”‚   â”‚ ğŸŸ¢ Beginner     â”‚   â”‚ ğŸ“š Tutorial     â”‚   â”‚                 â”‚
â”‚ ğŸŸ  High         â”‚   â”‚ ğŸš€ Series A     â”‚   â”‚ ğŸŸ¡ Intermediate â”‚   â”‚ ğŸ“° News         â”‚   â”‚                 â”‚
â”‚ ğŸŸ¡ Medium       â”‚   â”‚ ğŸ“ˆ Series B     â”‚   â”‚ ğŸ”´ Advanced     â”‚   â”‚ ğŸ’¡ Explanation  â”‚   â”‚                 â”‚
â”‚ ğŸŸ¢ Low          â”‚   â”‚ ğŸ¢ Series C+    â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚
â”‚                 â”‚   â”‚ ğŸ’¼ Late/PE      â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Volume Summary

| Stage | Input | Output |
|-------|-------|--------|
| Stage 1 (Fetch) | RSS ~150 + HN ~50 + YouTube ~10 | ~210 raw items |
| Stage 1 (Filter) | ~210 items | ~100 articles + 10 videos |
| Stage 2 (Classify) | ~100 articles | tech ~20 + investment ~80 + tips ~10 |
| Stage 3 (Process) | Classified articles | tech 30 + investment 21 + tips 15 + videos 5 (bilingual) |
| Stage 4 (Save) | Processed content | 71 database records total |

### Key Code Locations

| Functionality | File | Lines |
|--------------|------|-------|
| Classification logic | `llm_processor.py` | 95-161 |
| Tech article selection | `llm_processor.py` | 163-215 |
| Investment processing | `llm_processor.py` | 273-425 |
| Tips processing | `llm_processor.py` | 435-485 |
| Video processing | `llm_processor.py` | 217-271 |
| 4-stage pipeline | `collector.py` | 242-781 |
| Video interspersion | `collector.py` | 210-239 |
| HN fetching | `hn_fetcher.py` | 248-279 |
| Week boundary filter | `collector.py` | 41-114 |
| Config settings | `config.py` | 31-37 |

### Importance Evaluation System

Articles are evaluated and selected based on multiple dimensions:

| Dimension | Source | Purpose |
|-----------|--------|---------|
| **Relevance Score** | LLM Classification (0.0-1.0) | Initial sorting + selection |
| **Impact Level** | LLM Processing (critical/high/medium/low) | UI display weight |
| **HN Points** | Hacker News API | Community engagement signal |
| **Source Authority** | Feed reputation (MIT Tech Review, etc.) | LLM implicit consideration |
| **Duplicate Detection** | LLM identifies `duplicate_of` | Deduplication + best selection |

---

## Data Source Configuration

The data sources are optimized for **business users** (consultants, analytics teams) rather than developers.

### Hacker News Queries (18 keywords)

```python
HN_DEFAULT_QUERIES = [
    # General AI
    "AI", "LLM", "generative AI",
    # Major Products & Companies
    "ChatGPT", "Claude", "Gemini", "OpenAI", "Anthropic", "Perplexity",
    # Emerging Models
    "DeepSeek", "Grok",
    # Image & Video Generation
    "Sora", "Midjourney", "Stable Diffusion",
    # Business Applications
    "AI startup", "AI funding", "AI acquisition", "AI enterprise",
]
```

### YouTube Queries (25 keywords)

```python
queries = [
    # AI News
    "AI news this week", "AI business news",
    # Tool Tutorials
    "ChatGPT tutorial", "ChatGPT for business", "Claude AI tutorial",
    "Perplexity AI tutorial", "NotebookLM tutorial",
    # Workplace Productivity
    "AI productivity tips", "AI tools for work", "AI for Excel",
    "AI presentation", "AI automation workflow",
    # Business & Strategy
    "AI in finance", "AI for consulting", "AI strategy business",
    # German Content
    "KI News deutsch", "ChatGPT Tutorial deutsch", "KI Tools deutsch",
]
```

### Excluded (Too Technical)

The following were intentionally excluded as they target developers rather than business users:
- `transformer`, `neural network`, `deep learning`, `machine learning`
- `r/LocalLLaMA`, `r/StableDiffusion`, `r/MachineLearning`
- Developer tools: Cursor, Copilot, Devin

---

## Stock API (Polygon.io Integration)

The Secondary Market section now fetches **real-time stock data** from Polygon.io API instead of relying on LLM-generated prices.

### How It Works

```
Frontend (investment-feed.tsx)
    â”‚
    â”‚ 1. Load secondary market posts (ticker + content only)
    â”‚
    â–¼
Backend Proxy (/api/stock/formatted/batch/)
    â”‚
    â”‚ 2. Fetch real-time data from Polygon.io
    â”‚
    â–¼
Polygon.io API
    â”‚
    â”‚ 3. Return: price, change%, marketCap
    â”‚
    â–¼
Frontend merges data + displays with "Live" badge
```

### API Endpoints

| Endpoint | Description |
|----------|-------------|
| `GET /api/stock/{ticker}` | Single stock (raw data) |
| `GET /api/stock/batch/?tickers=AAPL,NVDA` | Batch stocks (raw data) |
| `GET /api/stock/formatted/{ticker}?language=en` | Pre-formatted for display |
| `GET /api/stock/formatted/batch/?tickers=...&language=de` | Batch formatted |

### Example Response

```json
// GET /api/stock/formatted/NVDA?language=en
{
  "ticker": "NVDA",
  "price": "$180.06",
  "change": "-2.98%",
  "direction": "down",
  "marketCap": "$4.5T",
  "name": "Nvidia Corp"
}

// GET /api/stock/formatted/NVDA?language=de
{
  "ticker": "NVDA",
  "price": "$180.06",
  "change": "-2.98%",
  "direction": "down",
  "marketCap": "$4,5 Bio.",
  "name": "Nvidia Corp"
}
```

### Configuration

Requires `POLYGON_API_KEY` environment variable (Polygon.io Starter Plan: $29/month, 15-min delayed data).

---

## Setup

### Prerequisites

- Python 3.11+
- PostgreSQL database
- API keys:
  - OpenRouter (for LLM)
  - YouTube Data API v3

### Local Development

1. Create virtual environment:
```bash
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
```

2. Install dependencies:
```bash
pip install -r requirements.txt
```

3. Configure environment:
```bash
cp .env.example .env
# Edit .env with your credentials
```

4. Initialize database:
```bash
python -m scripts.init_db --migrate-all
```

5. Run the server:
```bash
uvicorn app.main:app --reload
```

6. Access API docs at http://localhost:8000/docs

### Database Migrations

Using Alembic for schema migrations:

```bash
# Apply all migrations
alembic upgrade head

# Create new migration
alembic revision --autogenerate -m "description"

# Rollback one migration
alembic downgrade -1
```

## API Endpoints

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/weeks` | GET | List all available weeks |
| `/api/weeks/current` | GET | Get current week |
| `/api/tech/{weekId}` | GET | Tech feed (with videos) |
| `/api/investment/{weekId}` | GET | Investment feed |
| `/api/tips/{weekId}` | GET | Tips feed (15 DE + 15 EN) |
| `/api/trends/{weekId}` | GET | Trends feed |
| `/api/videos/{weekId}` | GET | YouTube videos only |
| `/api/stock/{ticker}` | GET | Real-time stock data |
| `/api/stock/batch/?tickers=...` | GET | Batch stock data |
| `/api/stock/formatted/{ticker}` | GET | Pre-formatted stock data |
| `/api/stock/formatted/batch/` | GET | Batch formatted stock data |
| `/api/admin/collect` | POST | Full collection (all stages) |
| `/api/admin/collect/fetch` | POST | Stage 1 only |
| `/api/admin/collect/process` | POST | Stages 2-4 only |
| `/api/admin/collect/ma` | POST | M&A-only reprocessing |
| `/api/admin/migrate` | POST | Migrate JSON data |
| `/health` | GET | Health check |

## Deployment to Railway

### 1. Create Railway Project

```bash
railway login
railway init
```

### 2. Add PostgreSQL Service

In Railway dashboard: **Add Service** â†’ **PostgreSQL**

### 3. Set Environment Variables

```bash
railway variables set DATABASE_URL=$RAILWAY_DATABASE_URL
railway variables set OPENROUTER_API_KEY=sk-or-v1-xxxxx
railway variables set YOUTUBE_API_KEY=AIzaSyxxxxx
railway variables set POLYGON_API_KEY=xxxxx              # For real-time stock data
railway variables set ADMIN_API_KEY=REDACTED_ADMIN_KEY
railway variables set CORS_ORIGINS='["http://localhost:3000","https://www.datacubeai.space","https://ai-information-hub.vercel.app"]'
```

### 4. Deploy

```bash
railway up
```

### 5. Initialize Database

After first deployment:
```bash
railway run python -m scripts.init_db --migrate-all
```

## Data Collection

### Full Collection (All Stages)

```bash
curl -X POST "https://api-production-3ee5.up.railway.app/api/admin/collect?week_id=2026-kw05" \
  -H "X-API-Key: REDACTED_ADMIN_KEY"
```

### Process Only (Reuse Raw Data)

Useful when you want to re-run LLM processing without re-fetching data:

```bash
curl -X POST "https://api-production-3ee5.up.railway.app/api/admin/collect/process?week_id=2026-kw05" \
  -H "X-API-Key: REDACTED_ADMIN_KEY"
```

### Fetch Only (No LLM Processing)

```bash
curl -X POST "https://api-production-3ee5.up.railway.app/api/admin/collect/fetch?week_id=2026-kw05" \
  -H "X-API-Key: REDACTED_ADMIN_KEY"
```

### Local Collection

```bash
python -m scripts.weekly_collect
python -m scripts.weekly_collect --week 2026-kw05
```

## Tips Processing

Tips sources bypass LLM classification in Stage 2. Current sources (14 total):

**Blogs:**
- Simon Willison
- One Useful Thing (Ethan Mollick)

**Reddit Communities:**
- r/ChatGPT, r/ClaudeAI, r/OpenAI, r/PromptEngineering
- r/Midjourney (image generation for marketing)
- r/perplexity_ai, r/NotebookLM (AI research tools)
- r/artificial, r/singularity (general AI discussion)
- r/aivideo, r/ElevenLabs (content creation)
- r/ChatGPTPro (pro users)

These sources:
- Are inherently tips/practical content
- Skip classification and retain `section="tips"`
- Ensure tips appear in the Tips feed

## M&A Processing

### M&A Data Sources (7 feeds)

M&A news is collected from dedicated financial and business news sources:

| Source | Type | URL |
|--------|------|-----|
| TechCrunch M&A | Tech M&A | `techcrunch.com/tag/mergers-and-acquisitions/feed/` |
| SEC EDGAR 8-K | Regulatory | `sec.gov/cgi-bin/browse-edgar?action=getcurrent&type=8-K&output=atom` |
| Financial Times M&A | Financial | `ft.com/mergers-acquisitions?format=rss` |
| Yahoo Finance | General | `finance.yahoo.com/rss/topstories` |
| GlobeNewswire M&A | PR | `globenewswire.com/.../Mergers%20and%20Acquisitions/...` |
| PR Newswire | PR | `prnewswire.com/rss/news-releases-list.rss` |
| Google News M&A | Aggregator | `news.google.com/rss/search?q=mergers+acquisitions+AI` |

These sources are fetched as part of the investment RSS collection but processed separately for M&A extraction.

### M&A Processing Flow

M&A data has two collection paths:

**Full Collection** (4-stage pipeline):
```
RSS Fetch (all sources) â†’ Classification â†’ LLM Processing â†’ Database
                                              â†“
                               process_investment_articles()
                               internally splits articles into:
                               â€¢ Primary Market (funding)
                               â€¢ Secondary Market (stocks)
                               â€¢ M&A (mergers & acquisitions)
```

**M&A-Only Collection** (3-stage fast path):
```
M&A RSS Fetch â†’ process_ma_articles() â†’ ma_posts table
     â†“
(Skips classification, doesn't touch other sections)
```

Use M&A-only collection when you want to refresh M&A data without reprocessing tech/tips:
```bash
curl -X POST ".../api/admin/collect/ma?week_id=2026-kw06" -H "X-API-Key: ..."
```

### AI Industry Taxonomy

M&A deals are classified into AI-specific industry categories:

| Category | Description |
|----------|-------------|
| AI Infrastructure | Cloud, chips, data centers, ML platforms, model providers |
| AI Healthcare | Medical AI, drug discovery, clinical AI, diagnostics |
| AI Finance | FinTech AI, algorithmic trading, risk assessment, fraud detection |
| AI Enterprise | B2B AI tools, SaaS AI, workflow automation, document AI |
| AI Consumer | Consumer apps, recommendation systems, voice assistants |
| AI Robotics | Industrial robots, autonomous vehicles, drones |
| AI Security | Cybersecurity AI, fraud detection, threat intelligence |
| AI Creative | Image/video generation, music AI, content creation |
| AI Education | EdTech AI, tutoring, learning platforms |
| Other AI | AI companies not fitting above categories |

**Note**: Only AI-related M&A deals are included. Deals with no clear AI connection are filtered out (industry = null).

### M&A-Only Reprocessing

To reprocess only the M&A section without affecting other sections:

```bash
curl -X POST "https://api-production-3ee5.up.railway.app/api/admin/collect/ma?week_id=2026-kw05" \
  -H "X-API-Key: REDACTED_ADMIN_KEY"
```

This is useful when you want to update M&A data with new sources or fix classification issues.

## Project Structure

```
ai-hub-backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py              # FastAPI entry point
â”‚   â”œâ”€â”€ config.py            # Environment config
â”‚   â”œâ”€â”€ database.py          # DB connection
â”‚   â”œâ”€â”€ models/              # SQLAlchemy models
â”‚   â”‚   â”œâ”€â”€ __init__.py      # All models
â”‚   â”‚   â””â”€â”€ raw.py           # Raw article/video storage
â”‚   â”œâ”€â”€ schemas/             # Pydantic schemas
â”‚   â”œâ”€â”€ routers/             # API routes
â”‚   â”‚   â”œâ”€â”€ admin.py         # Collection endpoints
â”‚   â”‚   â”œâ”€â”€ stock.py         # Real-time stock data (Polygon.io)
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ services/            # Business logic
â”‚       â”œâ”€â”€ collector.py     # 4-stage pipeline
â”‚       â”œâ”€â”€ rss_fetcher.py   # RSS feeds
â”‚       â”œâ”€â”€ hn_fetcher.py    # Hacker News
â”‚       â”œâ”€â”€ youtube_fetcher.py  # YouTube API
â”‚       â”œâ”€â”€ llm_processor.py # Two-model LLM
â”‚       â””â”€â”€ migrator.py      # JSON migration
â”œâ”€â”€ alembic/                 # DB migrations
â”œâ”€â”€ scripts/                 # CLI scripts
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ railway.toml
â””â”€â”€ requirements.txt
```

## Frontend Configuration

Set environment variable in Vercel:

```
NEXT_PUBLIC_API_URL=https://api-production-3ee5.up.railway.app/api
```

The frontend will automatically use the API when configured, with fallback to static JSON files.
